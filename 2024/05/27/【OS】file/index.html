<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="IO设备加磁盘加文件系统的理论总结">
<meta property="og:type" content="article">
<meta property="og:title" content="【OS】file">
<meta property="og:url" content="http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/index.html">
<meta property="og:site_name" content="碳罐堆积处">
<meta property="og:description" content="IO设备加磁盘加文件系统的理论总结">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603133446489.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603134857539.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603134913655.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603134941876.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603134958623.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603152815374.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603163252967.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603163306524.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603170957272.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603171005607.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603171013558.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603171024809.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240602205017820.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240602213926987.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603103951689.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603105542152.png">
<meta property="og:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603111112529.png">
<meta property="article:published_time" content="2024-05-27T02:15:47.000Z">
<meta property="article:modified_time" content="2024-06-05T13:25:47.573Z">
<meta property="article:author" content="Carbon">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/%E3%80%90OS%E3%80%91file/image-20240603133446489.png">


<link rel="canonical" href="http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/","path":"2024/05/27/【OS】file/","title":"【OS】file"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【OS】file | 碳罐堆积处</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">碳罐堆积处</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#IO"><span class="nav-number">1.</span> <span class="nav-text">IO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E6%8A%80%E6%9C%AF"><span class="nav-number">1.1.</span> <span class="nav-text">控制技术</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AF%E4%BB%B6%E7%BB%84%E6%88%90"><span class="nav-number">1.2.</span> <span class="nav-text">软件组成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="nav-number">1.2.1.</span> <span class="nav-text">设备独立性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.2.2.</span> <span class="nav-text">设备驱动程序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%86%B2%E7%AE%A1%E7%90%86"><span class="nav-number">1.3.</span> <span class="nav-text">缓冲管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86"><span class="nav-number">1.4.</span> <span class="nav-text">设备管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-O%E6%80%A7%E8%83%BD"><span class="nav-number">1.5.</span> <span class="nav-text">I&#x2F;O性能</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A3%81%E7%9B%98"><span class="nav-number">2.</span> <span class="nav-text">磁盘</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E7%BB%87%E4%B8%8E%E8%B0%83%E5%BA%A6"><span class="nav-number">2.2.</span> <span class="nav-text">组织与调度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BAMBR"><span class="nav-number">2.2.1.</span> <span class="nav-text">主引导扇区MBR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8DPT"><span class="nav-number">2.2.2.</span> <span class="nav-text">分区表DPT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%9C%B0%E5%9D%80%E4%B8%8E%E5%9D%97%E5%8F%B7%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="nav-number">2.2.3.</span> <span class="nav-text">磁盘地址与块号的转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E8%AE%BF%E9%97%AE%E6%97%B6%E9%97%B4"><span class="nav-number">2.2.4.</span> <span class="nav-text">磁盘访问时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86"><span class="nav-number">2.3.</span> <span class="nav-text">空间管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RAID"><span class="nav-number">2.4.</span> <span class="nav-text">RAID</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-O%E9%80%9F%E5%BA%A6"><span class="nav-number">2.5.</span> <span class="nav-text">I&#x2F;O速度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86%E5%AE%9E%E4%BE%8B"><span class="nav-number">2.6.</span> <span class="nav-text">磁盘管理实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">3.</span> <span class="nav-text">文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="nav-number">3.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95"><span class="nav-number">3.2.</span> <span class="nav-text">实现方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.2.1.</span> <span class="nav-text">文件的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FCB"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">FCB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E7%BB%AD%EF%BC%88%E9%A1%BA%E5%BA%8F%EF%BC%89"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">连续（顺序）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%B2%E8%81%94%EF%BC%88%E9%93%BE%E6%8E%A5%EF%BC%89"><span class="nav-number">3.2.1.3.</span> <span class="nav-text">串联（链接）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">3.2.1.4.</span> <span class="nav-text">索引</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.2.2.</span> <span class="nav-text">目录的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB"><span class="nav-number">3.2.3.</span> <span class="nav-text">共享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E6%8A%A4"><span class="nav-number">3.2.4.</span> <span class="nav-text">保护</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%83%BD"><span class="nav-number">3.2.5.</span> <span class="nav-text">性能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90"><span class="nav-number">3.3.</span> <span class="nav-text">实例分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ext2"><span class="nav-number">3.3.1.</span> <span class="nav-text">Ext2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FAT"><span class="nav-number">3.3.2.</span> <span class="nav-text">FAT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VFS"><span class="nav-number">3.3.3.</span> <span class="nav-text">VFS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%B3%A8%E5%86%8C%E4%B8%8E%E6%8C%82%E8%BD%BD"><span class="nav-number">3.3.4.</span> <span class="nav-text">文件系统的注册与挂载</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Carbon</p>
  <div class="site-description" itemprop="description">还没想出高级的博客名；出现问题欢迎交流指正喵。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【OS】file | 碳罐堆积处">
      <meta itemprop="description" content="IO设备加磁盘加文件系统的理论总结">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【OS】file
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-27 10:15:47" itemprop="dateCreated datePublished" datetime="2024-05-27T10:15:47+08:00">2024-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-05 21:25:47" itemprop="dateModified" datetime="2024-06-05T21:25:47+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">IO设备加磁盘加文件系统的理论总结</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h1><p>总线带宽=频率*宽度（Bytes/sec）</p>
<p><strong>外设管理功能：</strong></p>
<ul>
<li>提供设备使用的用户接口：命令接口、程序接口</li>
<li>设备分配和释放：使用设备前需要分配设备和相应的通道、控制器</li>
<li>设备的访问和控制：并发访问、差错处理</li>
<li>I/O缓冲和调度：提高I/O访问效率</li>
</ul>
<p><strong>设备控制器组成：</strong></p>
<p><img src="/images/【OS】file/image-20240603133446489.png" alt="image-20240603133446489" style="zoom:67%;"></p>
<ol>
<li>I/O端口地址指的是接口电路中每个寄存器的唯一地址，I/O端口地址空间受OS保护</li>
<li>I/O指令形式与I/O地址互相关联，主要有内存映像编址和I/O独立编址</li>
</ol>
<ul>
<li><p>内存映像编址指控制器的内存/寄存器作为物理内存空间的一部分。</p>
<ul>
<li>优点在于不需要特殊保护机制防止用户进程进行相应的I/O操作。操作系统要避免把包含了控制寄存器的地址空间放入用户虚拟地址空间中。并且可以引用内存的每条指令都可以适用于引用控制寄存器。</li>
<li>缺点在于不允许对一个控制寄存器的内容进行高速缓存。</li>
</ul>
</li>
<li><p>I/O独立编址是I/O专用指令，如Intel体系架构中in/out指令。</p>
<ul>
<li>优点在于外设不占用内存地址空间。编程时易于区分内存操作和I/O操作。</li>
<li>缺点在于I/O端口指令类型少，操作不灵活。</li>
</ul>
</li>
</ul>
<h2 id="控制技术"><a href="#控制技术" class="headerlink" title="控制技术"></a>控制技术</h2><ul>
<li><p><strong>程序控制I/O</strong>，也称轮询或查询方式I/O,它由CPU代表进程向I/O模块发出指令，然后进入忙等状态，直到操作完成之后进程才能够继续执行。</p>
<ul>
<li>注意轮询的是<strong>设备控制器</strong>是否完成执行过程，对于外围设备而言就是是否做好了接受或者传输数据的准备，而不是数据是否传输完毕。</li>
</ul>
</li>
<li><p><strong>中断驱动</strong>，当I/O操作结束后由设备控制器主动地来通知设备驱动程序，而不是依靠设备驱动程序不断地去轮询看看设备的状态。</p>
<ul>
<li>中断驱动是<strong>每个数据单位</strong>传送后都中断CPU，下面的DMA是传送一批之后才中断CPU。</li>
<li>数据传送在中断处理时由CPU控制完成，并且由于涉及程序切换，所以需要保护和恢复现场。进而也具有对异常事件的处理能力。</li>
</ul>
</li>
<li><strong>DMA</strong>，直接存储器访问方式，是由一个专门的控制器来完成数据从内存到设备或者是从设备到内存的传输工作。这是由于一般的数据传输都需要CPU参与，把搬运工作交给DMA处理，CPU就可以干其他的事去了。<ul>
<li>CPU只需干预I/O操作的开始和结束，后续读写无需CPU参与，适用于高速设备。基本流程是CPU发送start命令后，等DMA准备好后<strong>设置寄存器</strong>，然后把当前进程阻塞，进而调度其他进程运行。等收到中断信号后再转中断处理。</li>
<li>但数据传输的方向、存放数据的内存地址及传送数据的长度由CPU控制，占用CPU时间。且每个设备都占用一个DMA控制器，设备增加时需要增加新的DMA。</li>
</ul>
</li>
<li><strong>通道</strong>与DMA的原理几乎是一样的，可以进一步减少CPU的干预，并且可以做到一个通道控制多台设备。缺点是费用较高。通道是一个特殊功能的处理器，它有自已的指令和程序专门负责数据输入输出的传输控制。<ul>
<li>CPU只需发出启动指令，指出要求通道执行的操作和使用的I/O设备，该指令就可以启动通道并使该通道从内存中调出相应的通道程序执行。</li>
<li>通道与CPU分时使用内存，也就实现了CPU内部运算与I/O设备的并行工作。</li>
</ul>
</li>
</ul>
<p><img src="/images/【OS】file/image-20240603134857539.png" alt="image-20240603134857539"></p>
<p><img src="/images/【OS】file/image-20240603134913655.png" alt="image-20240603134913655"></p>
<p><img src="/images/【OS】file/image-20240603134941876.png" alt="image-20240603134941876"></p>
<p><img src="/images/【OS】file/image-20240603134958623.png" alt="image-20240603134958623"></p>
<h2 id="软件组成"><a href="#软件组成" class="headerlink" title="软件组成"></a>软件组成</h2><h3 id="设备独立性"><a href="#设备独立性" class="headerlink" title="设备独立性"></a>设备独立性</h3><p>为了实现设备独立性引入逻辑设备和物理设备的概念</p>
<ol>
<li>应用程序使用逻辑设备，系统转为物理设备执行</li>
<li>好处在于<strong>设备分配更灵活，且易于实现I/O重定向</strong>。更灵活是指用户不指定一台而是一类设备，则只有在该类设备中所有设备都被占用才会阻塞进程。重定向是指I/O设备容易更换而不需要改变应用程序内容。</li>
<li>系统需要有<strong>逻辑设备表</strong>LUT进行映射。该表包括逻辑设备名、物理设备名和设备驱动程序入口。</li>
<li>LUT可以有两种方式，在整个系统设置一张或为每个用户设置一张。系统同一张就不允许相同逻辑设备名。</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>逻辑设备名</th>
<th>物理设备名</th>
<th>驱动程序入口地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>/dev/tty</td>
<td>3</td>
<td>1024</td>
</tr>
<tr>
<td>/dev/printer</td>
<td>5</td>
<td>2046</td>
</tr>
</tbody>
</table>
</div>
<h3 id="设备驱动程序"><a href="#设备驱动程序" class="headerlink" title="设备驱动程序"></a>设备驱动程序</h3><p>构成：</p>
<ul>
<li>自动配置和初始化子程序：检测要驱动的硬件设备是否存在且正常，并且对于正常的设备需要对软件状态初始化</li>
<li>I/O操作子程序：调用后从用户态变成内核态</li>
<li>中断服务子程序</li>
</ul>
<p>接口：</p>
<ul>
<li>驱动程序初始化函数：向操作系统登记驱动程序的接口函数，在系统启动时安装入内核执行</li>
<li>驱动程序卸载函数，申请设备函数，释放设备函数</li>
<li>I/O操作函数</li>
<li>中断处理函数</li>
</ul>
<h2 id="缓冲管理"><a href="#缓冲管理" class="headerlink" title="缓冲管理"></a>缓冲管理</h2><blockquote>
<p>I/O子系统可以通过使用主存或磁盘上的存储空间的技术，如缓冲、高速缓存、假脱机等来改善效率。</p>
<p>缓冲区，是用于设备之间或设备与应用程序之间速度传输不匹配问题的，缓冲区在内存中。</p>
<p>磁盘高速缓存，是用内存中的存储空间来暂存从磁盘中读出的一系列盘块信息，是快速内存区。</p>
<p>假脱机，是把独享设备转变为具有共享特征的虚拟设备，在输出井申请的是磁盘块。</p>
</blockquote>
<ul>
<li>匹配CPU和外设速度</li>
<li>减少CPU中断次数</li>
<li>提高CPU和I/O并行性</li>
</ul>
<p><img src="/images/【OS】file/image-20240603152815374.png" alt="image-20240603152815374" style="zoom:80%;"></p>
<blockquote>
<p>ppt上写的双缓冲是<strong>近似Max(C，T)</strong></p>
</blockquote>
<p>循环缓冲：</p>
<ul>
<li><p>多个缓冲区，在循环缓冲区中包括多个缓冲区，每个缓冲区的大小相同，作为输入的多缓冲区可分为三种类型，<strong>用于装输入数据的空缓冲区R、已装满数据的缓冲区G以及计算进程正在使用的工作缓冲区C。</strong></p>
</li>
<li><p>多个指针，作为输入的缓冲区可设置三个指针，用于指示<strong>计算进程下一个可用缓冲区G的指针Nextg、指示输入进程下次可用的空缓冲区R的指针Nexti、以及用于指示计算进程正在使用的缓冲区C的指针Current。</strong></p>
</li>
</ul>
<p>缓冲池：</p>
<ul>
<li>将相同类型的缓冲区形成队列<ul>
<li>空缓冲队列emq</li>
<li>输入队列inq</li>
<li>输出队列outq</li>
</ul>
</li>
<li>缓冲区可以工作在四种工作方式下<ul>
<li>收容输入：输入进程在空队列取一个，装入，挂到<strong>输入队尾</strong>上</li>
<li>提取输入：计算进程在<strong>输入队首</strong>取一个，使用，挂到空队列上</li>
<li>收容输出和提取输出同理</li>
</ul>
</li>
</ul>
<h2 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h2><p>外设资源有限，需要解决进程间外设共享问题。</p>
<p>数据结构：</p>
<p><img src="/images/【OS】file/image-20240603163252967.png" alt="image-20240603163252967"></p>
<p><img src="/images/【OS】file/image-20240603163306524.png" alt="image-20240603163306524"></p>
<p><strong>用户空间的I/O软件</strong>：SPOOLing技术</p>
<p>概念：</p>
<ul>
<li>假脱机技术，把独享设备转变为具有共享特征的虚拟设备，从而提高设备利用率。</li>
<li>专门利用一道程序完成对应I/O操作，无需使用外围I/O处理机。这里是指应用程序直接和SPOOLing程序交换数据，而不是和实际外设交互，即虚拟IO。</li>
</ul>
<p>系统组成：</p>
<ul>
<li>SPOOLing系统主要由输入井和输出井、输入缓冲和输出缓冲、输入进程SPi和输出进程SPo组成。</li>
<li>输入井和输出井是在<strong>磁盘</strong>上开辟的两个大存储空间，用于存放从低速设备输入的信息或将要输出到低速设备的信息。</li>
<li>输入缓冲和输出缓冲是在内存中开辟的两个缓冲区，用于临时存储数据，实现数据的高速传输。</li>
</ul>
<p>工作原理：</p>
<ul>
<li>在输入过程中，信息从低速设备经过通道传输到内存中的输入缓冲区，当缓冲区满时，再将信息写入磁盘的输入井中。</li>
<li>在输出过程中，信息从内存的输出缓冲区传输到磁盘的输出井，再经过通道传输到低速设备。</li>
<li>通过这种方式，SPOOLing技术实现了在输入和输出之间增加“输入井”和“输出井”的排队转储环节，以消除用户的“联机”等待时间。</li>
</ul>
<p>比如将一台独享打印机改造为可供多个用户共享的打印机。系统对于用户的打印输出，先在输出井中申请一个空闲盘块区，并将要打印的数据送入其中；然后为用户申请并填写请求打印表，将该表挂到请求打印队列上。若打印机空闲，则依次将队列中的输出文件实际打印输出。</p>
<h2 id="I-O性能"><a href="#I-O性能" class="headerlink" title="I/O性能"></a>I/O性能</h2><p>解决I/O性能的途径：</p>
<ul>
<li>CPU利用率：缓冲技术、使用异步I/O使CPU不等I/O</li>
<li>CPU摆脱I/O：DMA、通道</li>
</ul>
<p><img src="/images/【OS】file/image-20240603170957272.png" alt="image-20240603170957272"></p>
<p><img src="/images/【OS】file/image-20240603171005607.png" alt="image-20240603171005607"></p>
<p><img src="/images/【OS】file/image-20240603171013558.png" alt="image-20240603171013558"></p>
<p><img src="/images/【OS】file/image-20240603171024809.png" alt="image-20240603171024809" style="zoom:67%;"></p>
<h1 id="磁盘"><a href="#磁盘" class="headerlink" title="磁盘"></a>磁盘</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>扇区（sector）</li>
<li>磁道（track）：同心圆</li>
<li>柱面（cylinder）：不同盘片相同半径的磁道组成的圆柱</li>
<li>磁头（head）：每个磁盘有两个面，每个面都有一个磁头（这里应该是把一整个存储设备叫做硬盘，而磁盘指的是其中的一片。每个柱面有多少个磁头可以类比为蛋糕有多少层，当然要除二）</li>
</ul>
<p>知识点：</p>
<ol>
<li>每个磁道的扇区数并不是常量</li>
<li>绝大多数磁盘都有一些缺陷扇区，在映射的时候需要用其他空闲扇区替代</li>
<li>硬盘实际扇区数比标签上标定的大。标签上只提到用户存储数据的区域，即工作区，工作区中会存在坏扇区。还有一部分用于存储硬盘固件供硬盘控制器使用，还有的是保留扇区。</li>
<li>磁盘缺陷</li>
</ol>
<ul>
<li>P表：永久缺陷列表，记录硬盘生产过程中产生的缺陷</li>
<li>G表：增长缺陷列表，记录硬盘使用过程中产生的缺陷</li>
</ul>
<h2 id="组织与调度"><a href="#组织与调度" class="headerlink" title="组织与调度"></a>组织与调度</h2><h3 id="主引导扇区MBR"><a href="#主引导扇区MBR" class="headerlink" title="主引导扇区MBR"></a>主引导扇区MBR</h3><ol>
<li>0柱面0磁头1扇区是主引导扇区，或称主引导记录，占用512字节（一个扇区通常就是512字节）。</li>
<li>MBR用于硬盘启动时将系统控制权转给用户指定的、在分区表中登记了的某个操作系统分区，所以其不属于任何一个操作系统，是公共引导。</li>
<li>MBR内容在硬盘分区时由分区软件写入。</li>
</ol>
<p><strong>MBR组成</strong></p>
<ul>
<li>前446字节为启动代码及数据（Bootloader）</li>
<li>之后是64字节的分区表（DPT）</li>
<li>最后还有两个字节的Magic Number，BIOS读取时总是检查最后是不是有这俩幻数，如果没有就认为这个硬盘未分区</li>
</ul>
<h3 id="分区表DPT"><a href="#分区表DPT" class="headerlink" title="分区表DPT"></a>分区表DPT</h3><ul>
<li>分区表分为4个部分，每个部分表示一个分区的信息，16字节</li>
<li>第0个字节是自举标志，值为80H时表示该分区为当前活动分区</li>
<li>第2至4字节为分区起始地址，即存了磁头号（第2字节）、扇区号（第3字节低6位）、柱面号（第3字节高2位+第3字节）。6至8同理，存结束地址。</li>
<li>第5字节为分区类型，包括未指定、FAT16、FAT32、扩展分区、NTFS分区、LBA模式扩展分区、Linux分区等，这些也叫文件系统类型</li>
</ul>
<p><strong>8.46GB问题</strong>：指柱面号最大为1024，扇区号最大为64-1（这里减去MBR），磁头号最大为256，相乘得到可支持的硬盘容量大小为8.46GB。</p>
<p>这里还介绍了<strong>INT 13服务扩展标准</strong>，不使用OS的寄存器传递寻址参数，而是使用存储在OS内存中的地址包（但是是LBA地址而非CHS地址）</p>
<h3 id="磁盘地址与块号的转换"><a href="#磁盘地址与块号的转换" class="headerlink" title="磁盘地址与块号的转换"></a>磁盘地址与块号的转换</h3><p>磁盘地址（CHS）</p>
<p>块号（LBA）：又称逻辑块号，现代磁盘驱动视为一维的逻辑块数组，逻辑块作为最小传输单位</p>
<blockquote>
<p>磁盘寻址方式应该是先找柱面，再找磁道，最后是扇区。这种地址转换题一定会给磁头数（NH）和扇区数（NS）。一个柱面的扇区总数是NH*NS，并且认为每个柱面的扇区数相同。之前说的每个磁道扇区数不是常量是因为外围的扇区会更多，那个是物理角度理解，但在用的时候得在逻辑上将其视为将其视为均匀的。</p>
</blockquote>
<p><img src="/images/【OS】file/image-20240602205017820.png" alt="image-20240602205017820" style="zoom: 80%;"></p>
<h3 id="磁盘访问时间"><a href="#磁盘访问时间" class="headerlink" title="磁盘访问时间"></a>磁盘访问时间</h3><p>访问时间=寻道时间+旋转延迟时间+传输时间</p>
<p>其中，寻道时间=启动磁盘的时间+磁头移动n条磁道花费的时间之和</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.375ex;" xmlns="http://www.w3.org/2000/svg" width="15.494ex" height="1.906ex" role="img" focusable="false" viewBox="0 -677 6848.5 842.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(617,-150) scale(0.707)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g></g><g data-mml-node="mo" transform="translate(1400.9,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2456.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(3556.9,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(4557.1,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5379.3,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6379.5,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g></g></svg></mjx-container></p>
<p>平均旋转延迟时间=磁盘转一圈所需时间的一半</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="8.257ex" height="2.755ex" role="img" focusable="false" viewBox="0 -864.9 3649.7 1217.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(617,-150) scale(0.707)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g></g><g data-mml-node="mo" transform="translate(1481.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2537.2,0)"><g data-mml-node="mn" transform="translate(379.5,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><rect width="872.5" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p>
<p>传输时间：每次读写的字节数b，旋转速度r（RPM），磁道上字节数N</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="8.241ex" height="2.8ex" role="img" focusable="false" viewBox="0 -884.7 3642.6 1237.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(617,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g><g data-mml-node="mo" transform="translate(1200,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2255.8,0)"><g data-mml-node="mi" transform="translate(541.7,394) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(451,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g></g><rect width="1146.8" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p>
<p><strong>磁盘寻道算法</strong></p>
<ul>
<li>FCFS：先来先服务</li>
<li><p>SSTF：最短寻道时间优先</p>
<ul>
<li>改善磁道平均服务时间</li>
<li>可能产生“饥饿”</li>
</ul>
</li>
<li><p>SCAN：电梯算法</p>
<ul>
<li>来回摆动到底</li>
<li>解决最短寻道的缺点</li>
<li>两侧被访问频率低于中间</li>
</ul>
</li>
<li>C-SCAN：循环扫描<ul>
<li>移动到最后一个柱面后立刻快速返回到0号柱面，期间不为其他等待访问者服务</li>
<li>解决SCAN算法缺点</li>
</ul>
</li>
<li>LOOK、C-LOOK：<ul>
<li>磁头移动只需要到达最远端即可返回</li>
<li>再优化</li>
</ul>
</li>
<li><p>N-Step-SCAN：</p>
<ul>
<li>请求队列分为若干个长度为N的子队列</li>
<li>N=1是FCFS，N很大是SCAN</li>
</ul>
</li>
<li><p>FSCANS：</p>
<ul>
<li>分为两个区域，当前请求和新请求</li>
<li>在扫描的过程中所有新产生的序列放在另外的一个队列中，当访问完当前队列之后，再访问新产生的一个队列</li>
</ul>
</li>
</ul>
<h2 id="空间管理"><a href="#空间管理" class="headerlink" title="空间管理"></a>空间管理</h2><ol>
<li>位图法</li>
<li>空闲表，存所有空闲块（起始块号+块数）</li>
<li>空闲链表法</li>
<li>成组链接法，空白物理块分成组，用指针把各组连起来。</li>
</ol>
<blockquote>
<p>举例来讲，比如一个空闲的盘块可以存储另外五个盘块的地址，那么这五个盘块必须有一个是指向下一个这样的盘块，其他四个是直接可用盘块。并且该盘块还要有区域存储 当前盘块存的 可用盘块地址数量（比如满了就是5）。然后在使用的时候，查询0号盘块，查到一个可用盘块后把0号盘块的数量标记为4。等取到只有一个的时候，由于这个指向的盘块也存了可用盘块的地址，那么把该盘块（比如记为1号）的内容<strong>复制到0号盘块</strong>中，之后就可以愉快地使用1号盘块了。这也是为什么标注了第一块是专用块。</p>
</blockquote>
<p><img src="/images/【OS】file/image-20240602213926987.png" alt="image-20240602213926987" style="zoom: 80%;"></p>
<h2 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a>RAID</h2><p>Flash Disk知识点：</p>
<ol>
<li>Flash Disk有NOR技术和NAND技术，NOR相对快一点，但贵得多</li>
<li>NAND地址分为三部分：块号、块内页号、页内字节号。所以一次数据访问需要经过三次寻址。</li>
<li>NOR地址线足够多，是一次性直接寻址。</li>
<li>Flash Disk优点是功耗低容量大速度快，但是问题在于反复读写存在擦除寿命。一个缓解方法是磨损均衡化。</li>
</ol>
<p>廉价冗余磁盘阵列RAID：</p>
<ul>
<li><p>优点：增加容量，且能容错。</p>
</li>
<li><p>技术：数据条带、镜像、数据校验。</p>
</li>
<li>数据条带：一个字节块可能存放在多个数据盘上（不是存多遍，而是把一份拆开存）<ul>
<li>并行存取，性能好</li>
<li>可靠性不强，不同io请求需要排队</li>
</ul>
</li>
<li>镜像：数据完全拷贝一份<ul>
<li>可靠性</li>
<li>存储开销大</li>
</ul>
</li>
<li>校验：数据通过某种运算得出，用于检验正确性<ul>
<li>可靠性</li>
<li>开销</li>
</ul>
</li>
</ul>
<h2 id="I-O速度"><a href="#I-O速度" class="headerlink" title="I/O速度"></a>I/O速度</h2><ul>
<li>选择性能好的磁盘</li>
<li>并行化</li>
<li>采用适当调度算法</li>
<li>设置磁盘高速缓冲区</li>
<li>优化数据布局（物理块尽量连续摆放、减少索引节点与数据块的距离，使其和数据块相结合）</li>
<li>提前读（顺序访问时提前读到缓冲区）延迟写（该写回的挂到空闲缓冲区队列末尾，直到移到链头再写回）</li>
<li>虚拟盘（利用内存空间仿真磁盘，不同于缓存的是这一部分由用户控制）</li>
</ul>
<h2 id="磁盘管理实例"><a href="#磁盘管理实例" class="headerlink" title="磁盘管理实例"></a>磁盘管理实例</h2><blockquote>
<p>放一放</p>
</blockquote>
<h1 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h1><blockquote>
<p>知识点弄的乱乱的，也可以直接看实例分析，把知识点按照更加通畅的逻辑又啰嗦了一遍。</p>
</blockquote>
<h2 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h2><p><strong>文件系统</strong>：为系统管理者和用户提供了对文件的透明存取</p>
<ul>
<li>不必了解文件存放的物理机制和查找方法，只需给定一个代表某段程序或数据的文件名称</li>
<li>文件系统就会自动地完成对给定文件名称相对应的文件的有关操作</li>
</ul>
<p>文件系统模型的细化：文件命令解释—目录检索—存取控制验证—逻辑文件系统—物理逻辑系统—设备策略—I/O控制系统—磁盘</p>
<p><strong>文件</strong>：本质上是一种抽象机制，可以视为一个单独的连续的逻辑地址空间，其大小为文件大小，<strong>与进程地址空间无关</strong></p>
<ul>
<li>文化体：文件本身的内容，由文件建立者和使用者解释</li>
<li>文件说明：存储管理的相关信息</li>
</ul>
<p>文件逻辑结构：</p>
<ul>
<li>以字节为单位的流式结构（基本单位为字符，有逻辑意义，无结构）</li>
<li>记录式文件结构（由记录组成，可以按照记录进行读写查找操作）</li>
<li>树形结构</li>
<li>…</li>
</ul>
<p>文件存取方式：</p>
<ul>
<li>顺序存取（访问）</li>
<li>随机存取：提供读写位置（当前位置）（不是真随机！）</li>
</ul>
<p><strong>目录</strong>：由文件说明索引组成的用于文件检索的特殊文件，内容主要是文件访问和控制的信息</p>
<p>目录内容为文件属性信息，其中一部分为用户可获取，包括文件名、别名的数目、文件类型、地址信息、访问控制信息、使用信息</p>
<ul>
<li>单级目录（仅有一个根目录，每个目录表目包括文件名、物理地址等等信息）</li>
<li>两级目录（在根目录下每个用户对应一个目录）</li>
<li>多级目录</li>
</ul>
<h2 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h2><h3 id="文件的实现"><a href="#文件的实现" class="headerlink" title="文件的实现"></a>文件的实现</h3><p><strong>描述文件</strong>，记录文件的管理信息</p>
<h4 id="FCB"><a href="#FCB" class="headerlink" title="FCB"></a>FCB</h4><p><strong>基本信息</strong></p>
<p>• 文件名：字符串，通常在不同系统中允许不同的最大长度。可以修改。</p>
<p>• 物理位置；</p>
<p>• 文件逻辑结构：有/无结构（记录文件，流式文件）</p>
<p>• 文件物理结构：（如顺序，索引等）</p>
<p><strong>访问控制信息</strong></p>
<p>• 文件所有者（属主）：通常是创建文件的用户，或者改变已有文件的属主；</p>
<p>• 访问权限（控制各用户可使用的访问方式）：如读、写、执行、删除等；</p>
<p><strong>使用信息</strong></p>
<p>• 创建时间，上一次修改时间，当前使用信息等。</p>
<hr>
<p><strong>存放文件</strong>，将文件各个连续逻辑块存放在磁盘空闲物理块中，记录逻辑块与物理块映射关系</p>
<p>文件物理结构：</p>
<ul>
<li>文件被分为N块，在磁盘上如何存放</li>
<li>地址在FCB中如何记录</li>
</ul>
<h4 id="连续（顺序）"><a href="#连续（顺序）" class="headerlink" title="连续（顺序）"></a>连续（顺序）</h4><h4 id="串联（链接）"><a href="#串联（链接）" class="headerlink" title="串联（链接）"></a>串联（链接）</h4><p>每个物理块的最末一个字(或第一个字)作为链接字，它指出后继块的物理地址。链首指针存放在该文件目录中。文件的结尾块的指针为“∧” ，表示文件至本块结束。</p>
<p>对于记录式文件一块中可包含一个逻辑记录或多个逻辑记录，也可以若干物理块包含一个逻辑记录。</p>
<ul>
<li>空间利用率高</li>
<li>随机存取效率太低，指针出错不安全，链接指针占一定空间</li>
</ul>
<h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><p>系统为每个文件建立一个专用数据结构：索引表，并将这些物理块的块号存放在该索引中。</p>
<p>由于每个文件索引表长度不一样，索引表不能直接存在FCB中，FCB只记录索引表的地址。</p>
<p><strong>索引文件</strong>：文件由数据文件和索引表构成。</p>
<p>索引表位置可以在文件目录中，可以在文件开头。索引表大小一般固定。</p>
<p>访问索引式文件：</p>
<ul>
<li>查索引区，由逻辑块号查得物理块号</li>
<li>查数据区，由此物理块号从磁盘上获得所要求的数据</li>
</ul>
<p>直接索引：<strong>文件目录下记录文件名和对应的iNode</strong>，查找到对应iNode内容可知物理块索引。</p>
<p>一次间接索引：iNode内容0-9是物理块索引对应文件内容，10是指向另一个iNode，里面存有更多的物理块索引号</p>
<p>二次间接索引：iNode内容0-9是物理块索引对应文件内容，10是指向另一个iNode，里面都存的是其他iNode，再下一层才是物理块号</p>
<h3 id="目录的实现"><a href="#目录的实现" class="headerlink" title="目录的实现"></a>目录的实现</h3><p><strong>内容</strong>上，需要给定一个文件名可以返回相应的FCB</p>
<ul>
<li>直接法：目录项=文件名+FCB</li>
<li>间接法：目录项=文件名+FCB地址（索引号）如Unix（inode）</li>
</ul>
<p>支持<strong>可变长度文件名</strong></p>
<ul>
<li>固定文件名长度（浪费空间）</li>
<li>目录项长度可变，分为目录项长度、文件属性信息（此两项长度固定）、文件名（长度可变）（文件被删除后目录项所占空间不好回收）</li>
<li>目录项长度固定，把长度可变的文件名统一放在目录文件末尾</li>
</ul>
<p>目录<strong>搜索</strong>方法</p>
<ul>
<li>顺序查询：扫描符号文件目录中的表目，比较名字字段</li>
<li>Hash方法：将符号名唯一地变换成符号表中表目索引</li>
</ul>
<h3 id="共享"><a href="#共享" class="headerlink" title="共享"></a>共享</h3><ul>
<li><p>硬连接：两个目录项FileName不同但对应inode相同</p>
<ul>
<li>硬链接是指向文件inode（索引节点）的一个指针。一个文件可以有多个硬链接，但只有一个inode。</li>
<li>创建硬链接不会增加inode的数量，只是给文件增加了一个或多个文件名。</li>
<li>删除一个文件的硬链接不会立即删除文件内容或inode，只有当文件的最后一个硬链接被删除时，inode和文件内容才会被释放。</li>
<li>硬链接不能跨文件系统创建，因为它们依赖于inode，而inode只在单个文件系统中有效。</li>
<li>不能对目录创建硬链接（某些文件系统可能允许，但通常不推荐）。</li>
</ul>
</li>
<li><p>软连接：创建一个新的文件，该文件的用户数据块中存放的内容是指向另一个文件的路径名</p>
<ul>
<li>创建软链接会创建一个新的inode和新的文件名。</li>
<li>删除软链接文件本身只是删除了这个特殊的文件，不会影响被链接的文件或目录。</li>
<li>软链接可以跨文件系统创建，因为它们是基于路径的。</li>
<li>可以对目录创建软链接。</li>
<li>如果软链接所指向的原始文件被移动、重命名或删除，软链接将变得“断开”或“死”，指向一个不存在的文件或目录。</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">'Test1'</span> &gt; x</span><br><span class="line">$ <span class="built_in">ln</span> -s x xx</span><br><span class="line">$ <span class="built_in">ln</span> -s xx xxx</span><br><span class="line">$ <span class="built_in">ln</span> x xxxx</span><br><span class="line">$ <span class="built_in">rm</span> x</span><br><span class="line">$ <span class="built_in">cat</span> x xx xxx xxxx</span><br><span class="line"><span class="built_in">cat</span>: x: No such file or directory</span><br><span class="line"><span class="built_in">cat</span>: xx: No such file or directory</span><br><span class="line"><span class="built_in">cat</span>: xxx: No such file or directory</span><br><span class="line">Test1</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'Test2'</span> &gt; x</span><br><span class="line">$ <span class="built_in">cat</span> x xx xxx xxxx</span><br><span class="line">Test2</span><br><span class="line">Test2</span><br><span class="line">Test2</span><br><span class="line">Test1</span><br></pre></td></tr></table></figure>
<p>==先touch再cat？？？？？？==</p>
<h3 id="保护"><a href="#保护" class="headerlink" title="保护"></a>保护</h3><ul>
<li>建立副本<ul>
<li>适用于短小且极为重要的文件</li>
</ul>
</li>
<li><p>定时转储</p>
<ul>
<li>每隔一定时间把文件转储到其他存储介质上</li>
</ul>
</li>
<li><p>文件一致性检查</p>
</li>
<li>存取控制</li>
</ul>
<h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p>• 目录项（FCB）分解、当前目录、磁盘碎片整理</p>
<p>• 块高速缓存、磁盘调度、提前读取</p>
<p>• 合理分配磁盘空间、信息的优化分布</p>
<p>• RAID技术等</p>
<p><strong>块高速缓存</strong></p>
<p>在内存中为磁盘块设置的一个缓冲区，保存了磁盘中某些块的副本</p>
<p>组织方式：数据块用双向链表组织，要访问某块则从链中拿出来挂到链尾（很可能再次使用）。并且由于需要检查需要使用的某块是否在高速缓存中，故还需要使用块号进行散列</p>
<p><strong>基于日志结构的文件系统</strong></p>
<ul>
<li>LFS的基本假设是系统有足够大的快取记忆体（缓存），使得磁盘机的动作主要集中在写入上（因为读取大多会从缓存进行）。</li>
</ul>
<ul>
<li>所有的写操作仅在日志头完成，也就是对日志的追加</li>
<li>新的<strong>数据块和元数据（inode、目录）</strong>总共作为日志先放在缓存中，当日志区满了或者达到一定条件时，LFS会将日志区的内容整理成一个<strong>段</strong>，并将其写入磁盘的空闲区域。</li>
</ul>
<p>读写操作</p>
<ul>
<li>每个写操作的执行都会在内存的segment缓冲区加入新的数据块；当segment写满了之后, 其中的数据会写到磁盘</li>
<li>读操作与Unix文件系统基本相同，只是在寻找inode时需要用到缓存在内存中的inode map</li>
<li>随着不断的读写操作，由于新的数据块会不断替换文件中原来的数据块，结果segment会逐渐碎片化</li>
</ul>
<p>LFS机制下<strong>失效恢复非常快</strong></p>
<p>但主要问题是<strong>清理</strong>，即cleaning，目的是提供连续的空闲磁盘空间（但不是清理磁盘，而是清理segment保证写回时写入的东西是连续的）</p>
<h2 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h2><h3 id="Ext2"><a href="#Ext2" class="headerlink" title="Ext2"></a>Ext2</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/alantu2018/p/8472105.html">讲的很清晰的博客</a></p>
<p>文件系统中存储最小单位是块（Block），块大小在格式化时确定。但引导块（Boot Block）应该是由统一标准固定的，不归文件系统管。</p>
<p>EXT2文件系统把分区分为若干个相同大小的块组（Block Group），每个块组包括：</p>
<ul>
<li>超级块（Super Block）1块<ul>
<li>描述分区的文件系统信息，如块大小、文件系统版本号、上次 mount的时间等。在每个块组开头都有拷贝。</li>
</ul>
</li>
<li>块组描述符表（GDT）n块<ul>
<li>存储该块组的描述信息，如inode表起始地址，数据块起始地址，空闲inode和数据块个数等等。同样有拷贝。</li>
</ul>
</li>
<li>块位图1块<ul>
<li>由于块位图只能占一个块，所以可以限制分区的块组个数（限制块组中包含的块的数量）</li>
</ul>
</li>
<li>inode位图（索引节点位图）1块</li>
<li>inode表（索引节点表）n块<ul>
<li>文件描述信息存在inode中而非数据块中</li>
</ul>
</li>
<li>数据块n块</li>
</ul>
<p><img src="/images/【OS】file/image-20240603103951689.png" alt="image-20240603103951689" style="zoom:67%;"></p>
<p><img src="/images/【OS】file/image-20240603105542152.png" alt="image-20240603105542152" style="zoom:67%;"></p>
<p>访问小文件只需要两次读盘操作：一次读 inode，一次读数据块</p>
<p>最大的文件需要五次读盘操作：inode、一级间接寻址块、二级间接寻址块、三级间接寻址块、数据块</p>
<h3 id="FAT"><a href="#FAT" class="headerlink" title="FAT"></a>FAT</h3><p>MS DOS文件系统特点：</p>
<ol>
<li>多级目录</li>
<li>无文件别名</li>
<li>无用户访问权限控制</li>
</ol>
<p><img src="/images/【OS】file/image-20240603111112529.png" alt="image-20240603111112529" style="zoom:67%;"></p>
<p>之前不是说磁盘MBR中DPT把硬盘分为四块吗，这里四块就分别是保留区（MBR，DBR），FAT区和数据区。FAT区由文件分配表组成，FAT1和FAT2互为备份。数据区按照簇进行管理，一个簇包含若干个扇区。</p>
<h3 id="VFS"><a href="#VFS" class="headerlink" title="VFS"></a>VFS</h3><p>使不同文件系统看起来相同的抽象</p>
<h3 id="文件系统的注册与挂载"><a href="#文件系统的注册与挂载" class="headerlink" title="文件系统的注册与挂载"></a>文件系统的注册与挂载</h3>
    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Carbon
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/" title="【OS】file">http://example.com/2024/05/27/【OS】file/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/05/19/%E3%80%90OS%E3%80%91lab5/" rel="prev" title="【OS】lab5">
                  <i class="fa fa-angle-left"></i> 【OS】lab5
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/06/02/%E3%80%90OS%E3%80%91process/" rel="next" title="【OS】process">
                  【OS】process <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Carbon</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
