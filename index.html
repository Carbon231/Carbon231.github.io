<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
<meta property="og:type" content="website">
<meta property="og:title" content="碳罐堆积处">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="碳罐堆积处">
<meta property="og:description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Carbon">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>碳罐堆积处</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">碳罐堆积处</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Carbon</p>
  <div class="site-description" itemprop="description">还没想出高级的博客名；出现问题欢迎交流指正喵。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/05/%E3%80%90OS%E3%80%91backup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/05/%E3%80%90OS%E3%80%91backup/" class="post-title-link" itemprop="url">【OS】backup</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-06-05 19:27:11 / 修改时间：21:43:19" itemprop="dateCreated datePublished" datetime="2024-06-05T19:27:11+08:00">2024-06-05</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>看到的一些零碎知识点，答案和结论不保真。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/06/05/%E3%80%90OS%E3%80%91backup/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/05/Untitled/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/05/Untitled/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-05 19:22:56" itemprop="dateCreated datePublished" datetime="2024-06-05T19:22:56+08:00">2024-06-05</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/02/%E3%80%90OS%E3%80%91process/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/02/%E3%80%90OS%E3%80%91process/" class="post-title-link" itemprop="url">【OS】process</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-02 19:43:17" itemprop="dateCreated datePublished" datetime="2024-06-02T19:43:17+08:00">2024-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-05 16:49:50" itemprop="dateModified" datetime="2024-06-05T16:49:50+08:00">2024-06-05</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ol>
<li><p>并发concurrent：无论是否在同一处理机，起点终点相同</p>
</li>
<li><p>并行parallel：同时运行在不同处理机上，起点终点相同</p>
</li>
<li>程序并发执行特点是间断、非封闭、不可再现</li>
<li>不可再现是因为发生竞争。竞争条件是多个进程并发访问和操作同一数据且执行结果与访问的特定顺序有关</li>
<li>Bernstein条件：不会发生竞争的条件。一个进程写的时候另一个不能读，两个进程不能同时写。这是也是判断程序并发执行结果是否可再现的充分条件。</li>
<li>进程特征：并发（间断性），共享（互相制约，非封闭），不确定性（不可再现）</li>
</ol>
<p><strong>进程与程序的区别</strong></p>
<ul>
<li>进程是动态的，程序是静态的：程序是有序代码的集合；进程是程序的执行。通常进程不可在计算机之间迁移；而程序通常对应着文件，静态和可以复制。</li>
<li>进程是暂时的，程序是永久的：进程是一个状态变化的过程，程序可长久保存。</li>
<li>进程与程序的组成不同：进程的组成包括程序、数据和进程控制块(即进程状态信息)。</li>
<li>进程与程序的对应关系：通过多次执行，一个程序可对应多个进程；通过调用关系，一个进程可包括多个程序。</li>
</ul>
<p><strong>进程实体</strong></p>
<ul>
<li>PCB</li>
<li>共享正文段：全局赋值变量、常量</li>
<li>数据堆段：<code>malloc()</code>动态分配的变量</li>
<li>数据栈段：函数调用、未赋值的局部变量</li>
</ul>
<h3 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h3><p><strong>原语</strong></p>
<ul>
<li>必须在管态（内核态）下执行，且常驻内存</li>
<li>不可中断</li>
<li>进程创建（fork, exec）撤销（kill）都是原语</li>
</ul>
<p><strong>创建</strong></p>
<ul>
<li>提交一个批处理作业</li>
<li>用户登录</li>
<li>OS创建</li>
<li>已有的进程创建<ul>
<li>Fork()：一次执行两次返回（返回先后不确定）。子进程返回值为0，父进程返回值为新建子进程的PID。如果出现错误则返回负值。</li>
</ul>
</li>
</ul>
<p><strong>撤销</strong></p>
<ul>
<li>用户退出登录</li>
<li>进程执行终止服务请求</li>
<li>出错</li>
<li>正常结束</li>
<li>给定时限到</li>
</ul>
<p><strong>状态转换</strong></p>
<p><img src="/images/【OS】process/image-20240603194616552.png" alt="image-20240603194616552" style="zoom:50%;"></p>
<ul>
<li>就绪-&gt;执行：时间片到</li>
<li>运行-&gt;就绪：时间片用完；高优先级进程就绪而导致当前进程被中断</li>
<li>运行-&gt;阻塞：所需资源或条件必须等待；初始化I/O并等待结果；等待其他进程提供输入IPC</li>
<li>阻塞-&gt;就绪：等待事情发生</li>
</ul>
<p><strong>进程控制块</strong>PCB</p>
<ul>
<li>进程标志符</li>
<li>程序和数据地址</li>
<li>当前状态<ul>
<li>OS会把相同状态的进程组成一个队列</li>
</ul>
</li>
<li>现场保护</li>
<li>同步与同步机制<ul>
<li>用于实现进程间互斥同步和通信的信号量等</li>
</ul>
</li>
<li>优先级</li>
<li>资源清单<ul>
<li>除CPU外的资源记录，如I/O设备、打开的文件列表等</li>
</ul>
</li>
<li>链接字<ul>
<li>该进程所在调度队列下一个进程的首地址</li>
</ul>
</li>
<li>其他信息</li>
</ul>
<p><strong>PCB组织方式</strong></p>
<ul>
<li>线性表（可能有多个指针，但都直接指向PCB）</li>
<li>索引（在线性表的基础上建立索引，如有就绪表指针指向就绪索引表，进而找到对应的PCB）</li>
<li>链接（按照进程状态组成队列）</li>
</ul>
<p><strong>进程上下文切换和陷入内核</strong></p>
<ul>
<li><p>上下文切换由调度器执行，保存进程执行断点，切换内存映射</p>
</li>
<li><p>陷入内核（模式切换）是CPU状态改变，由中断、异常、Trap（系统调用）引起，需要保存执行现场（寄存器堆栈等）。切换代价比上下文切换小。</p>
</li>
</ul>
<h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><ol>
<li>线程是进程中的可执行单位，并发粒度更细，且可以共享资源。</li>
<li>进程是<strong>资源分配</strong>的单位，线程是<strong>CPU调度</strong>的单位（这个说法有点奇怪但标红了还是记一下）</li>
</ol>
<h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h3><p><strong>用户级线程</strong>ULT</p>
<ul>
<li>通过library模拟，不需要或仅需要少数kernel支持</li>
<li>上下文切换快，因为不需要更新页表，线程切换和内核无关</li>
<li>现成调度由应用决定，更容易优化</li>
<li>可执行在任何操作系统上</li>
<li>OS内核不可感知</li>
<li>不足在于阻塞一个会所有相关线程，且内核只能将处理器分配给进程，无法实现一个进程中多线程并行执行</li>
</ul>
<p><strong>内核级线程</strong>KLT</p>
<ul>
<li>kernel有好几个分身</li>
<li>内核可以在多个处理器上调度一个进程的多个线程实行同步并行执行</li>
<li>阻塞也发生在线程级别</li>
<li>内核的一些处理也可以通过多线程实现</li>
<li>不足在于一个进程中线程切换需要内核参与，进而涉及到模式切换而降低效率</li>
</ul>
<p><strong>总结</strong></p>
<ul>
<li>在只有用户级线程的系统内，CPU调度还是以进程为单位，处于运行状态的进程中的多个线程，由用户程序控制线程的轮换运行</li>
<li>在有内核级线程的系统内，CPU调度则以线程为单位,由OS的线程调度程序负责线程的调度。</li>
<li>用户级线程的程序实体是运行在用户态下的程序，而内核级线程的程序实体则是可以运行在任何状态下的程序。</li>
</ul>
<p><strong>混合实现</strong></p>
<ul>
<li>线程在用户空间创建和管理</li>
<li>需要实现从用户空间线程到内核空间线程的映射</li>
</ul>
<p><img src="/images/【OS】process/image-20240603201306208.png" alt="image-20240603201306208" style="zoom: 50%;"></p>
<p><img src="/images/【OS】process/image-20240603201455796.png" alt="image-20240603201455796"></p>
<h2 id="同步与互斥"><a href="#同步与互斥" class="headerlink" title="同步与互斥"></a>同步与互斥</h2><h3 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h3><ul>
<li><p>临界资源：一次仅允许一个进程访问的资源。</p>
</li>
<li><p>临界区：每个进程中访问临界资源的那段代码称为临界区。</p>
</li>
<li><p>互斥：某一资源同时只允许一个访问者对其进行访问，具有唯一性和排它性。互斥无法限制访问者对资源的访问顺序，即<strong>访问是无序访问</strong>。</p>
</li>
<li><p>同步：是指在互斥的基础上，通过其它机制实现访问者对资源的<strong>有序访问</strong>。在大多数情况下，同步已经实现了互斥，特别是所有对资源的写入的情况必定是互斥的。少数情况是指可以允许多个访问者同时访问资源。</p>
</li>
</ul>
<p>机制上需要满足</p>
<ul>
<li>空闲让进：临界资源处于空闲状态，允许进程进入临界区。临界区内仅有一个进程运行。</li>
<li>忙则等待：临界区有正在执行的进程，所有其他进程则不可以进入临界区。</li>
<li>有限等待：对要求访问临界区的进程，应保证在有限时间内进入自己的临界区，避免死等。</li>
<li>让权等待：当进程(长时间)不能进入自己的临界区时，应立即释放处理机，尽量避免忙等。</li>
</ul>
<h3 id="基于忙等待的互斥"><a href="#基于忙等待的互斥" class="headerlink" title="基于忙等待的互斥"></a>基于忙等待的互斥</h3><p><strong>软件层面</strong></p>
<ul>
<li>如果是检查，则需要注意检查-进入间隙切换</li>
<li>对于标记占有，严格限制进入顺序的设计也被认为不好</li>
<li>标记占有，在进入前检查对方是否进入，则可能导致都进不去</li>
<li>凡有让权就要小心同时进入</li>
</ul>
<h4 id="Dekker"><a href="#Dekker" class="headerlink" title="Dekker"></a>Dekker</h4><p>P：我只关注对方想不想进入</p>
<ol>
<li>当我想进入，先标记一下（<code>pturn=true</code>），再看对方想不想</li>
<li>如果对方想，则检查一下是不是我的回合（<code>turn=0</code>）。如果是，我等到（<code>while(qturn)</code>）对方不想进去再进去。如果不是，则我自愿放弃，等（<code>while(turn==1);</code>）到重新是我的回合再说我想进。</li>
<li>我用完了，回合让给别人（唯一更改turn的地方），我不想进</li>
</ol>
<p><img src="/images/【OS】process/image-20240603213417250.png" alt="image-20240603213417250" style="zoom:50%;"></p>
<h4 id="Peterson"><a href="#Peterson" class="headerlink" title="Peterson"></a>Peterson</h4><ol>
<li>我想进去。</li>
<li>但我不要这个回合（唯一更改turn的地方）</li>
<li>如果别人也不想进去，那我就直接进去了。如果别人要，但是我的回合，那我就进去吧。如果别人要且是别人的回合，那我就再等等（<code>while(turn==other &amp;&amp; interested[other]==true);</code>）。</li>
<li>我用完了，我不想进去。</li>
</ol>
<p><img src="/images/【OS】process/image-20240603214503365.png" alt="image-20240603214503365" style="zoom:50%;"></p>
<h4 id="Bakery"><a href="#Bakery" class="headerlink" title="Bakery"></a>Bakery</h4><ol>
<li>取号进去，号码总是单调不减的，号码最小的进程先进</li>
<li>如果号码相同，则进程号小的先进</li>
</ol>
<p><img src="/images/【OS】process/image-20240603220859443.png" alt="image-20240603220859443" style="zoom:50%;"></p>
<hr>
<p><strong>硬件层面</strong></p>
<h4 id="中断屏蔽"><a href="#中断屏蔽" class="headerlink" title="中断屏蔽"></a>中断屏蔽</h4><ul>
<li>进入临界区后关中断</li>
<li>简单</li>
<li>不适合多CPU系统</li>
<li>会带来性能损失以及使用危险</li>
</ul>
<h4 id="test-and-set"><a href="#test-and-set" class="headerlink" title="test and set"></a>test and set</h4><p>TS是不可中断的基本原语，会把1写到某个内存位置并且返回旧值。如果一个进程正在执行TS指令，在它执行完成前，其它的进程不可以执行TS指令。</p>
<p>应用举例：<strong>自旋锁</strong>Spinlocks</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">acquire(lock) {</span><br><span class="line">   <span class="keyword">while</span>(test_and_set(lock)==<span class="number">1</span>); </span><br><span class="line">}</span><br><span class="line"><span class="comment">//如果lock的值为0（表示锁当前未被占用），test_and_set会返回0（旧值），并将lock设置为1（表示现在锁被该线程占用）。然后，while循环结束，线程可以继续执行临界区（critical section）的代码。</span></span><br><span class="line"><span class="comment">//如果lock的值为1（表示锁当前被其他线程占用），test_and_set会返回1（旧值），并尝试将lock设置为1（但因为它已经是1了，所以实际上这个设置操作没有效果）。然后，while循环继续执行，线程进入忙等待（busy-waiting）状态，直到lock变为0。</span></span><br><span class="line">release(lock) {</span><br><span class="line">    lock=<span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="优先级反转"><a href="#优先级反转" class="headerlink" title="优先级反转"></a>优先级反转</h4><p>优先级反转发生是由于<strong>低优先级进程运行在临界区时由于高优先级进程就绪而被切换</strong>。如果高优先级进程使用<strong>忙等</strong>的策略尝试进入临界区，就会一直忙等，使得低优先级进程没有机会离开临界区。如果使用用户级线程，低优先级线程不会被高优先级线程抢占(进入临界区一般需要系统调用，其他线程也同时会被阻塞),因为抢占发生在进程级别。但是对于内核级线程的实现，这个是可能发生的。</p>
<h3 id="基于信号量的方法"><a href="#基于信号量的方法" class="headerlink" title="基于信号量的方法"></a>基于信号量的方法</h3><p>信号量：一个确定的二元组(s,q)，其中s是一个具有非负初值的整型变量，q是一个初始状态为空的队列。</p>
<p><img src="/images/【OS】process/image-20240603223025725.png" alt="image-20240603223025725" style="zoom: 50%;"></p>
<p><img src="/images/【OS】process/image-20240603223131163.png" alt="image-20240603223131163" style="zoom: 67%;"></p>
<p><code>compare-and-swap (CAS)</code>也是一条原子指令。它将存储位置的内容与给定值进行比较，并且只有它们相同时，才将该存储位置的内容修改为新的给定值。</p>
<p><strong>信号量的应用</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>应用</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>互斥</td>
<td>信号量初始为1。进程进入临界区前P，出来后V。</td>
</tr>
<tr>
<td>有限并发</td>
<td>信号量初始值设为可共享资源数。</td>
</tr>
<tr>
<td>进程同步</td>
<td>进程Pi需要执行ai操作得等Pj执行完aj后。实现如下：Pi执行ai前P一下，Pj执行aj后V一下。</td>
</tr>
</tbody>
</table>
</div>
<p><strong>屏障</strong>Barriers/Rendezvous</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">s<span class="number">0</span> = Semaphore<span class="comment">(0)</span>;</span><br><span class="line">s<span class="number">1</span> = Semaphore<span class="comment">(0)</span>;</span><br><span class="line"></span><br><span class="line">P<span class="number">0</span>:</span><br><span class="line">V<span class="comment">(s0)</span>;</span><br><span class="line">P<span class="comment">(s1)</span>;</span><br><span class="line"></span><br><span class="line">P<span class="number">1</span>:</span><br><span class="line">V<span class="comment">(s1)</span>;</span><br><span class="line">P<span class="comment">(s0)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">n=nuber of thread;</span><br><span class="line">count=<span class="number">0</span>;  <span class="comment">//到达汇合点的线程数</span></span><br><span class="line">mutex=Semaphore(<span class="number">1</span>);  <span class="comment">//保护count</span></span><br><span class="line">barrier = Semaphore(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">P(mutex);</span><br><span class="line">count += <span class="number">1</span>;</span><br><span class="line">V(mutex);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(count == n) V(barrier);  <span class="comment">//唤醒一个</span></span><br><span class="line">P(barrier);  <span class="comment">//阻塞在这里</span></span><br><span class="line">V(barrier);  <span class="comment">//被唤醒的有责任唤醒下一个</span></span><br></pre></td></tr></table></figure>
<p><strong>信号量集</strong></p>
<p>需要访问多个资源s1，s2…</p>
<ul>
<li>AND型：一次性分配，一次性释放</li>
<li>一般：可以在AND机制上进行扩充，对于信号量Si，当其值低于ti时不予分配，并且可以需求占用di个。<code>SP(s1, t1, d1, ..., Sn, tn, dn)</code>和<code>SV(s1, d1, ..., sn, dn)</code></li>
</ul>
<h3 id="基于管程的同步与互斥"><a href="#基于管程的同步与互斥" class="headerlink" title="基于管程的同步与互斥"></a>基于管程的同步与互斥</h3><ol>
<li>管程的实现由编程语言负责，如java中的<code>synchronized()</code></li>
<li>为了区别等待的不同原因，引入条件变量。条件变量上可以做wait和signal操作。比如条件变量名为x，则x.wait()会把当前进程阻塞在x队列中，x.signal()会把x队列中一个进程唤醒</li>
<li>wait一定会阻塞当前进程。如果没等待进程signal会丢失</li>
</ol>
<p><strong>Hoarse管程</strong></p>
<ul>
<li>入口等待队列：尝试进入的等待</li>
<li>紧急等待队列：被唤醒但进不去</li>
</ul>
<p>信号量定义：</p>
<ul>
<li>管程用于互斥访问的信号量mutex（初值为1）。进程调用P，退出V。且wait操作也要V。</li>
<li>信号量next（初值为0），发出signal的进程需要p，直到被释放的进程退出管程或其他。进程退出管程前必须检查是否有别的进场在next上等待，若有则V。</li>
<li>信号量x-sem（初值为0），申请资源得不到满足时P，signal需要让x-sem等待进程立刻恢复。</li>
</ul>
<p><img src="/images/【OS】process/image-20240604102052946.png" alt="image-20240604102052946" style="zoom:50%;"></p>
<h3 id="进程通信"><a href="#进程通信" class="headerlink" title="进程通信"></a>进程通信</h3><p>低级通信：信号量、管程</p>
<p>高级通信：</p>
<ul>
<li>共享存储（最快）：线程天然共享进程空间（顺便提一嘴线程栈指针不共享）（Linux中线程是进程实现资源共享的一种方式）<ul>
<li>意义是同一块物理内存被映射到AB各自的进程地址空间</li>
<li>共享内存可以同时读但不能同时写，故需要同步机制约束（互斥锁或信号量）</li>
</ul>
</li>
<li>消息传递：由操作系统提供的发送信息和接受信息两个原语实现<ul>
<li>有阻塞调用和非阻塞调用方式。</li>
<li>操作系统空间中存在一组消息缓冲区。</li>
<li>需要解决消息丢失、延迟问题。以及编址问题。</li>
</ul>
</li>
<li>管道通信：管道也算一种文件，只能单向（若需要双向通信需要两个管道），且最多只能有一个进程进行读/写操作。依赖编译器。<ul>
<li>无名管道：单独构成独立的文件系统，只存在于内存中。只能是有亲缘关系之间创建。</li>
<li>有名管道：提供路径名，以FIFO的文件形式存在。<code>mkfifo()</code>创建。</li>
</ul>
</li>
</ul>
<p>信号量实现消息通信Send原语</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="attribute">buf-empty</span>=N;</span><br><span class="line"><span class="attribute">buf-full</span>=0;</span><br><span class="line"><span class="attribute">mutex1</span>=1;</span><br><span class="line"><span class="attribute">mutex2</span>=1;</span><br><span class="line"></span><br><span class="line">send(des, message) {</span><br><span class="line">根据des找接受进程；</span><br><span class="line">若未找到，出错返回；</span><br><span class="line"></span><br><span class="line">申请空缓冲区P(buf-empty);</span><br><span class="line">P(mutex1);</span><br><span class="line">取空缓冲区；</span><br><span class="line">V(mutex1);</span><br><span class="line"></span><br><span class="line">把消息从message复制到空缓冲区；</span><br><span class="line"></span><br><span class="line">P(mutex2);</span><br><span class="line">把消息缓冲区挂到接收进程消息队列；</span><br><span class="line">V(mutex2);</span><br><span class="line"></span><br><span class="line">V(buf-full);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="经典进程同步与互斥"><a href="#经典进程同步与互斥" class="headerlink" title="经典进程同步与互斥"></a>经典进程同步与互斥</h3><h4 id="生产者-消费者"><a href="#生产者-消费者" class="headerlink" title="生产者-消费者"></a>生产者-消费者</h4><ol>
<li>行为上，生产者之间互斥，消费者之间互斥，生产者和消费者同步互斥。</li>
<li>信号量，初始化设置互斥mutex=1，空闲数量empty=N，产品数量full=0</li>
<li>mutex需要放得近，否则可能全阻塞了。</li>
</ol>
<h4 id="读者-写者"><a href="#读者-写者" class="headerlink" title="读者-写者"></a>读者-写者</h4><ol>
<li>行为上，读者和读者共享Data，互斥访问readcount。读者写者以及写者写者都是互斥访问Data。</li>
<li>信号量，初始化正在读的进程数readcount=0，readcount互斥访问rmutex=1，Data互斥访问mutex=1。</li>
<li>读者先readcount互斥访问，如果之前没有读者则由他来P(mutex)，并rc++。读完后再rc互斥访问，rc—，如果已经没有其他读者了则由他来V(mutex)。</li>
<li>一般“信号量集”机制，mx表示允许写，初值为1，L表示允许读者数目，初值Rn。限制条件是读者最多Rn个。对写者，<code>SP(mx, 1, 1; L, Rn, 0)</code>写互斥所以是mx是1，1，并且只有在没有人正在读才能进去，所以L是Rn，0。<code>SV(mx, 1)</code>。对读者，<code>SP(L, 1, 1; mx, 1, 0)</code>同上，<code>SV(L, 1)</code>。</li>
<li>以上是读者有利。</li>
<li>读写公平的方法：新增信号量w，在读者写者都套一层PV，写者套在最外面，读者刚进入就可以P(w)，如果此时有写者在排队则不让继续进行，且读者刚进行完count的自增就可以V(w)了。</li>
</ol>
<h4 id="哲学家进餐"><a href="#哲学家进餐" class="headerlink" title="哲学家进餐"></a>哲学家进餐</h4><ol>
<li>死锁：所有人都无法进餐。饥饿：有人永远拿不到筷子。</li>
<li>破除互斥的解法：最多只允许四个人同时尝试进餐</li>
<li>破除循环等待的解法：筷子编号，哲学家按编号从低到高拿。或对哲学家编号，奇数人先拿左再拿右，偶数相反。</li>
<li>破除保持等待：同时拿起两根筷子或不拿起。</li>
</ol>
<p>以同时拿起为例</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Semaphore CS[<span class="number">5</span>]={<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1</span>};</span><br><span class="line">Semaphore mutex=<span class="number">1</span>;  <span class="comment">//取筷子信号量</span></span><br><span class="line"></span><br><span class="line">Pi() {</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) {</span><br><span class="line">        P(mutex);</span><br><span class="line">        P(CS[i]);</span><br><span class="line">        P(CS[(i+<span class="number">1</span>)%<span class="number">5</span>]);</span><br><span class="line">        V(mutex);</span><br><span class="line">        eat;</span><br><span class="line">        V(CS[i]);</span><br><span class="line">        V(CS[(i+<span class="number">1</span>)%<span class="number">5</span>]);</span><br><span class="line">        think;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h2><h3 id="概念-3"><a href="#概念-3" class="headerlink" title="概念"></a>概念</h3><p>竞争资源导致死锁，资源包括：</p>
<ul>
<li>可剥夺资源：CPU、内存</li>
<li>非可剥夺资源：只能等进程用完后自行释放，如磁带机、打印机</li>
<li>临时性资源：一个进程产生被另一个进程使用，如消息、中断</li>
</ul>
<p><strong>死锁发生的四个必要条件</strong>：</p>
<ul>
<li>互斥</li>
<li>请求和保持：已经占有但还提出新的请求，而新的请求被别的进程占有，故一直不释放资源</li>
<li>不可剥夺：未使用完之前不能被剥夺</li>
<li>环路等待</li>
</ul>
<p><strong>活锁</strong></p>
<p>不被阻塞，但一直在重复尝试。可能自行解开。一种简单的方法是先来先服务。</p>
<p><strong>饥饿</strong></p>
<p>资源分配不均而长时间等待。拖到即使完成也没实际意义了就称进程饿死。</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ul>
<li>不允许死锁发生<ul>
<li>预防（静态）：破坏死锁产生条件</li>
<li>避免（动态）：资源分配前判断</li>
</ul>
</li>
<li>允许死锁发生<ul>
<li>检测与解除</li>
<li>无所作为：鸵鸟算法</li>
</ul>
</li>
</ul>
<h4 id="死锁预防"><a href="#死锁预防" class="headerlink" title="死锁预防"></a>死锁预防</h4><p>从四个必要条件出发</p>
<ul>
<li>互斥<ul>
<li>允许同时访问。一般很难实现。</li>
</ul>
</li>
<li>请求和保持<ul>
<li>只有系统能够满足才一次性全分配，否则不分配</li>
<li>动态执行则难以预测，且资源利用率低（只有占有所有资源才执行），降低并发</li>
</ul>
</li>
<li>不可剥夺<ul>
<li>已经占有资源，而新申请资源不能被满足，则需释放占有的全部资源。相当于强行剥夺。</li>
<li>实现困难，降低性能。</li>
</ul>
</li>
<li>环路等待<ul>
<li>资源有序分配。进程对资源的请求必须严格按照资源序号递增提出。</li>
<li>难以编号，增加系统开销。暂用不到的也要申请，故增加进程对资源占用时间。</li>
</ul>
</li>
</ul>
<h4 id="死锁避免"><a href="#死锁避免" class="headerlink" title="死锁避免"></a>死锁避免</h4><p>区别于预防，限制的不是很严格</p>
<ul>
<li>安全序列：若对于每一个进程Pi,它需要的资源可以被系统中当前可用资源加上所有进程Pj(j&lt;i)当前占有资源之和所满足，则{P1, P2 … Pn}为一个安全序列。</li>
<li>安全状态：系统存在一个进程执行序列</li>
<li>系统进入不安全状态也不一定死锁</li>
</ul>
<p>银行家算法：</p>
<p><img src="/images/【OS】process/image-20240603203722724.png" alt="image-20240603203722724"></p>
<p><img src="/images/【OS】process/image-20240603203735890.png" alt="image-20240603203735890"></p>
<h4 id="检测死锁"><a href="#检测死锁" class="headerlink" title="检测死锁"></a>检测死锁</h4><ol>
<li>一般是绘制资源分配图（RAG）判断。</li>
<li>有环路不一定死锁</li>
<li>资源分配图的化简方法：先满足请求，再释放（删边使其为孤立节点）</li>
<li>死锁定理：系统中某个时刻t为死锁状态的充要条件是<strong>t时刻系统的资源分配图是不可完全化简的。</strong></li>
</ol>
<p><img src="/images/【OS】process/image-20240603204656713.png" alt="image-20240603204656713" style="zoom: 67%;"></p>
<h4 id="死锁解除"><a href="#死锁解除" class="headerlink" title="死锁解除"></a>死锁解除</h4><p>一般有两种方法</p>
<ul>
<li><p>剥夺资源：使用挂起/激活挂起一些进程，剥夺它们的资源以解除死锁，待条件满足时，再激活进程。</p>
</li>
<li><p>撤消进程：使全部死锁的进程夭折掉；按照某种顺序逐个地撤消(回退)进程，直至有足够的资源可用，死锁状态消除为止。</p>
</li>
</ul>
<p>需要注意</p>
<ul>
<li>怎样保证不发生“饥饿”现象，如何保证并不总是剥夺同一进程的资源</li>
<li>“最小代价”，即最经济合算的算法，使得进程回退带来的开销最小。</li>
</ul>
<h2 id="调度"><a href="#调度" class="headerlink" title="调度"></a>调度</h2><h3 id="概念-4"><a href="#概念-4" class="headerlink" title="概念"></a>概念</h3><p><strong>解决的问题</strong></p>
<ul>
<li>WHAT：进程调度算法</li>
<li>WHEN：进程调度时机<ul>
<li>只要OS取得CPU控制，进程切换就可能会发生</li>
<li>用户调用：程序显示请求（如打开文件）该进程可能会阻塞</li>
<li>陷进：指令出错导致当前进程终止</li>
<li>中断：外部因素影响</li>
</ul>
</li>
<li>HOW：CPU切换过程<ul>
<li>保存处理器上下文，包括PC和其他寄存器</li>
<li>更新当前进程的PCB</li>
<li>把进程移到合适的队列</li>
<li>选择另一个进程，切换PCB</li>
<li>重新装入CPU上下文</li>
</ul>
</li>
</ul>
<p><strong>调度类型</strong></p>
<ul>
<li>高级调度：作业调度，用户角度作业调度</li>
<li>中级调度：内外存交换，存储器资源管理</li>
<li>低级调度：进程或线程调度，CPU资源管理</li>
</ul>
<p>性能参数</p>
<ul>
<li>周转时间：作业提交到完成经历的时间（批处理）</li>
<li>响应时间：用户输入请求到系统首次给出相应的时间（分时系统）</li>
<li>截止时间：开始截止和完成截止（实时系统）</li>
<li>优先级<ul>
<li>静态、动态</li>
<li>一种方式是创建进程后给一个优先级，按照优先级排队；另一种方式是进程创建后优先级相同，随着运行降低优先级</li>
</ul>
</li>
<li>公平性<ul>
<li>不可抢占：只有在自己进入阻塞或者时间片用完才让出</li>
<li>抢占式：就绪队列中有优先级高于当前进程的立刻调度</li>
</ul>
</li>
<li>吞吐量：单位时间内完成的作业数（批处理）。平均周转时间不是吞吐量的倒数，因为并发的作业在时间上可以重叠</li>
<li>处理机利用率：（大中型主机）</li>
</ul>
<h3 id="批处理系统调度算法"><a href="#批处理系统调度算法" class="headerlink" title="批处理系统调度算法"></a>批处理系统调度算法</h3><p><img src="/images/【OS】process/image-20240604120054557.png" alt="image-20240604120054557" style="zoom:67%;"></p>
<ul>
<li>先来先服务FCFS：非抢占，利于长作业和CPU繁忙的作业</li>
<li>最短作业优先SJF：非抢占，提高吞吐量，缩减等待时间，不利于长作业</li>
<li>最短剩余时间优先SRTN：SJF改进为抢占式</li>
<li>最高响应比优先HRRN：非抢占式，选择响应比最大的投入运行<ul>
<li>RP=（作业已等待时间+作业服务时间）/作业服务时间</li>
<li>短作业容易得到较高响应比，长作业等足够久后也能得到高响应比</li>
</ul>
</li>
</ul>
<h3 id="交互式系统调度算法"><a href="#交互式系统调度算法" class="headerlink" title="交互式系统调度算法"></a>交互式系统调度算法</h3><ul>
<li>时间片轮转RR<ul>
<li>若是FIFO，时间片过长退化成FCFS，过短则上下文切换频繁，响应时间长</li>
<li>若是优先级算法，则又分为抢占式和非抢占式，静态优先级和动态优先级。</li>
</ul>
</li>
<li>多级队列MQ<ul>
<li>不同队列可有不同的优先级、时间片长度、调度策略等；在运行过程中还可改变进程所在队列。如：系统进程、用户交互进程、批处理进程等。</li>
</ul>
</li>
<li>多级反馈队列MFQ<ul>
<li>不必估计进程的执行时间，动态调节</li>
<li>规定优先级越低则时间片越长</li>
<li>新进程进入内存后，先投入队列1的末尾，按FCFS算法调度；若按队列1一个时间片未能执行完，则降低投入到队列2的末尾，同样按FCFS算法调度；如此下去，降低到最后的队列，则按“时间片轮转”算法调度直到完成。</li>
<li>仅当较高优先级的队列为空，才调度较低优先级的队列中的进程执行。如果进程执行时有新进程进入较高优先级的队列，则抢先执行新进程，并把被抢先的进程投入原队列的末尾。</li>
</ul>
</li>
</ul>
<p><strong>优先级倒置现象</strong></p>
<p>A和C共享临界资源，A由于C被阻塞，再因为B的存在延长了被阻塞的时间</p>
<p>解决方案：</p>
<ul>
<li>优先级置顶：C在临界区中具有最高优先级，不允许被抢占</li>
<li>优先级进程：C在临界区中优先级与A相同</li>
</ul>
<h3 id="实时系统的调度算法"><a href="#实时系统的调度算法" class="headerlink" title="实时系统的调度算法"></a>实时系统的调度算法</h3><p>前提条件：</p>
<ul>
<li>任务集已知</li>
<li>任务是周期性的，运行独立的，运行时间不变的</li>
</ul>
<h4 id="静态表调度"><a href="#静态表调度" class="headerlink" title="静态表调度"></a>静态表调度</h4><ul>
<li>事先确定一个固定的调度方案</li>
<li>无任何计算，按固定方案进行，开销最小。无灵活性。</li>
</ul>
<h4 id="单调速率调度RMS"><a href="#单调速率调度RMS" class="headerlink" title="单调速率调度RMS"></a>单调速率调度RMS</h4><ul>
<li>任务周期越小，优先级越高</li>
<li>如果优先级相同则随机选择一个</li>
<li>RMS是静态最优调度算法</li>
<li>会出现失效的情况，即在下一个周期开始后上一个周期的任务还未被执行</li>
</ul>
<h4 id="最早截止期优先EDF"><a href="#最早截止期优先EDF" class="headerlink" title="最早截止期优先EDF"></a>最早截止期优先EDF</h4><ul>
<li>任务的绝对截止时间越早，优先级越高</li>
</ul>
<h4 id="最低松弛度优先算法LLF"><a href="#最低松弛度优先算法LLF" class="headerlink" title="最低松弛度优先算法LLF"></a>最低松弛度优先算法LLF</h4><ul>
<li>松弛度Laxity=任务截止时间-本身剩余运行时间-当前时间</li>
<li>调度时机：有进程执行完或有进程的Laxity=0</li>
</ul>
<h3 id="多处理机调度"><a href="#多处理机调度" class="headerlink" title="多处理机调度"></a>多处理机调度</h3><ul>
<li>非对称式多处理系统AMP：主一从处理机系统，由主处理机管理一个公共就绪队列，并分派进程给从处理机执行。</li>
<li><p>对称式多处理系统SMP：多处理器系统中，各个处理器的地位相同。</p>
<ul>
<li>集中控制：静态、动态</li>
<li>分散控制：自调度</li>
</ul>
</li>
<li><p>静态分配：每个CPU设立一个就绪队列，进程从开始执行到完成，都<strong>在同一个CPU上</strong>。</p>
</li>
<li>动态分配：各个CPU采用一个公共就绪队列，队首进程每次分派到当前空闲的CPU上执行。可防止系统中多个处理器忙闲不均。</li>
<li>自调度：所有CPU采用一个公共就绪队列，每个处理机都可以从队列中选择适当进程来执行。需要对就绪队列的数据结构进行<strong>互斥访问控制</strong>。最常用的算法，实现时易于移植，采用单处理机的调度技术。<ul>
<li>不需要专门的处理机从事任务分派工作</li>
<li>当处理机个数较多(如十几个或上百个)时，对就绪队列的访问可能成为系统的瓶颈</li>
<li>低效、线程切换</li>
</ul>
</li>
<li><p>成组调度：将一个进程中的一组线程，每次同时分派到一组处理机上执行，在剥夺处理机时也同时对这一组线程进行。</p>
<ul>
<li>提高了这些线程的执行并行度，有利于减少阻塞和加快推进速度，最终提高系统吞吐量。</li>
<li>系统内线程总数相同时能够减少调度次数，从而减少调度算法的开销。</li>
<li>面向程序平分（两个进程各占一半时间）、面向线程平分（进程线程多的占更多时间，闲置的CPU时间也就变少了）</li>
</ul>
</li>
<li><p>专用处理机调度：为进程中的每个线程都固定分配一个CPU,直到该线程执行完成。适用于CPU数量众多的高度并行系统。</p>
<ul>
<li>线程执行时不需切换，相应的开销可以大大减小，推进速度更快。</li>
<li>线程阻塞时，造成CPU的闲置。</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/27/%E3%80%90OS%E3%80%91file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/27/%E3%80%90OS%E3%80%91file/" class="post-title-link" itemprop="url">【OS】file</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-27 10:15:47" itemprop="dateCreated datePublished" datetime="2024-05-27T10:15:47+08:00">2024-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-05 21:25:47" itemprop="dateModified" datetime="2024-06-05T21:25:47+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>IO设备加磁盘加文件系统的理论总结</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/05/27/%E3%80%90OS%E3%80%91file/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/19/%E3%80%90OS%E3%80%91lab5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/19/%E3%80%90OS%E3%80%91lab5/" class="post-title-link" itemprop="url">【OS】lab5</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-19 21:27:53" itemprop="dateCreated datePublished" datetime="2024-05-19T21:27:53+08:00">2024-05-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-29 17:55:01" itemprop="dateModified" datetime="2024-05-29T17:55:01+08:00">2024-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>lab5实验笔记</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/05/19/%E3%80%90OS%E3%80%91lab5/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/07/%E3%80%90OS%E3%80%91lab4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/07/%E3%80%90OS%E3%80%91lab4/" class="post-title-link" itemprop="url">【OS】lab4</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-07 14:26:05" itemprop="dateCreated datePublished" datetime="2024-05-07T14:26:05+08:00">2024-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-29 16:07:12" itemprop="dateModified" datetime="2024-05-29T16:07:12+08:00">2024-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>lab4实验笔记</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/05/07/%E3%80%90OS%E3%80%91lab4/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/01/%E3%80%90OO%E3%80%91hw3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/01/%E3%80%90OO%E3%80%91hw3/" class="post-title-link" itemprop="url">【OO】hw3</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-01 19:58:59" itemprop="dateCreated datePublished" datetime="2024-05-01T19:58:59+08:00">2024-05-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-16 12:00:06" itemprop="dateModified" datetime="2024-05-16T12:00:06+08:00">2024-05-16</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="测试过程"><a href="#测试过程" class="headerlink" title="测试过程"></a>测试过程</h2><h3 id="黑盒测试-amp-白盒测试"><a href="#黑盒测试-amp-白盒测试" class="headerlink" title="黑盒测试&白盒测试"></a>黑盒测试&amp;白盒测试</h3><p>​    黑盒测试是不需要了解软件系统的内部结构或实现细节，仅仅基于系统的功能规格和需求来设计测试用例和测试场景。白盒测试是基于对代码的理解验证系统的内部逻辑是否正确，是否覆盖了所有的路径和分支。</p>
<p>​    本单元中最常用和最直接的测试方式仍然是黑盒测试。在初步编写完代码后，黑盒测试可以用大量数据测试代码是否能正常运作，是否在部分情况会出现bug。以往的我盲目相信黑盒测试，以至于认为通过了评测机的考验就大概率是没有bug的。这样忽略了两点，其一，评测机也是人造的，如果搭建评测机的人没有意识到某个可能出现bug的点，或者根本理解错误，那么该评测机也是错的。其二，评测机大多是通过随机生成数据，其中会有很多指令是触发异常的无效指令，即使在大量数据的倾倒下真正有用的信息也不多，针对本次复杂的关系网络，很难保证已经测试到所有的情况。</p>
<p>​    我对白盒测试比较直观的理解是人脑构造数据尽可能覆盖所有情况。构造数据已经很麻烦了，还要绞尽脑汁覆盖所有情况，这显然是工作量很大的事情。对于一些逻辑简单的代码，白盒测试似乎就没有很必要。而对于一些过于复杂的情况，比如计算<code>blockSum</code>，该怎样才算是“覆盖了所有情况”呢？也难以界定。所以，白盒测试（至少在这样小规格项目中）适用情况并不多。但有一种情况尤其适合白盒测试，即涉及到很多隐性的<code>if...else</code>判断的方法。比如本单元中<code>coupleSum</code>的计算，其值只可能在增加或者修改关系的时候变化，这时候就尤其适合进行白盒测试，检查每一种情况是否检测到了变化并正确记录，以及是否有效的修改。</p>
<h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>单元测试是最小级别的测试，通常由开发者编写和执行，用于验证代码中的最小可测试单元（如函数、方法、类等）的行为是否符合预期。</p>
<h3 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h3><p>功能测试验证软件系统是否按照需求规格说明书的规定正常实现，关注于软件系统的功能是否完整、正确，以及是否满足用户需求。</p>
<h3 id="集成测试"><a href="#集成测试" class="headerlink" title="集成测试"></a>集成测试</h3><p>集成测试在单元测试之后进行，旨在验证软件系统中不同模块之间的接口和交互是否正常，关注于模块之间的集成和交互，确保它们能够协同工作并产生正确的结果。这个主要是可以发现模块之间的接口问题、数据传递问题以及功能冲突。在本单元中JML已经规定好一切，故不涉及集成测试，然而该方法在其他面向对象编程是非常重要的测试方法。</p>
<h3 id="回归测试"><a href="#回归测试" class="headerlink" title="回归测试"></a>回归测试</h3><p>回归测试是在软件开发生命周期的后期阶段进行的，用于验证之前已经通过测试的代码在修改后是否仍然保持原有的功能和性能。当开发者修复了软件中的一个缺陷或增加了新的功能后，需要执行回归测试来确保这些修改没有引入新的问题或导致旧的问题重新出现。回归测试在协作项目中应该有很大的帮助，对于我们而言即是测试本次作业的修改是否会导致之前作业某项功能错误或无法正常实现。</p>
<h3 id="数据构造"><a href="#数据构造" class="headerlink" title="数据构造"></a>数据构造</h3><ul>
<li>基于需求构造，模拟正常情况和异常情况</li>
<li>根据指定的规则或范围生成大量随机数据</li>
<li>针对输入数据的边界值进行测试，如负数、范围边缘</li>
<li>构建不同情况的数据，如稀疏图和稠密图</li>
</ul>
<h2 id="架构框架"><a href="#架构框架" class="headerlink" title="架构框架"></a>架构框架</h2><p>总体来说按照JML固定的架构完成，对于异常情况设置了一个<code>Counter</code>类完成计数，对于<code>Network</code>中图模型设置了一个<code>Dsu</code>类使用存储图结构并使用并查集算法管理连通性问题。</p>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><p>本次作业尝试了多种容器管理，以<code>MyPerson</code>类为例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//通常使用PersonId查找Person或判断是否相识，故使用HashMap	</span></span><br><span class="line"><span class="keyword">private</span> HashMap&lt;Integer, Person&gt; acquaintance;</span><br><span class="line"><span class="comment">//需要按照Value的大小对Person进行排序，主要服务于判断bestAcquaintance</span></span><br><span class="line"><span class="comment">//同时需要不断增加、修改和删除元素，PriorityQueue难以满足需求，故使用TreeSet</span></span><br><span class="line"><span class="keyword">private</span> TreeSet&lt;Person&gt; acquaintanceByValue;</span><br><span class="line"><span class="comment">//message需要按照顺序存储，并且涉及取出最新的五条消息、将新增消息插入至队首的操作，故使用LinkedList</span></span><br><span class="line"><span class="keyword">private</span> LinkedList&lt;Message&gt; messages;</span><br></pre></td></tr></table></figure>
<p>值得一提的是<code>TreeSet</code>需要重写<code>CompareTo</code>方法，如果相减可能会超<code>int</code>范围，当然也可以这样写，不是最简洁但比较稳妥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="built_in">this</span>.acquaintanceByValue = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(((o1, o2) -&gt; {</span><br><span class="line">            <span class="type">int</span> <span class="variable">id1</span> <span class="operator">=</span> o1.getId();</span><br><span class="line">            <span class="type">int</span> <span class="variable">id2</span> <span class="operator">=</span> o2.getId();</span><br><span class="line">            <span class="type">int</span> <span class="variable">vc</span> <span class="operator">=</span> Integer.compare(values.get(id1), values.get(id2));</span><br><span class="line">            <span class="keyword">if</span> (vc != <span class="number">0</span>) {</span><br><span class="line">                <span class="keyword">return</span> -vc;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">else</span> {</span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o1.getId(), o2.getId());</span><br><span class="line">            }</span><br><span class="line">        }));</span><br></pre></td></tr></table></figure>
<h3 id="图的管理"><a href="#图的管理" class="headerlink" title="图的管理"></a>图的管理</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> HashMap&lt;Integer, Integer&gt; parent;  <span class="comment">//节点的父节点</span></span><br><span class="line">   <span class="keyword">private</span> HashMap&lt;Integer, Integer&gt; rank;  <span class="comment">//方便按秩合并</span></span><br><span class="line">   <span class="keyword">private</span> HashMap&lt;Integer, HashSet&lt;Integer&gt;&gt; graph;  <span class="comment">//图的原始结构</span></span><br><span class="line">   <span class="keyword">private</span> HashMap&lt;Integer, HashMap&lt;Integer, Integer&gt;&gt; counted;  <span class="comment">//计算过的两点之间的ShortestPath</span></span><br><span class="line">   <span class="keyword">private</span> <span class="type">boolean</span> countedDirty;  <span class="comment">//若Dirty则需要将counted清零重新计算</span></span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> blockCnt;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> tripleCnt;</span><br></pre></td></tr></table></figure>
<p><code>Dsu</code>类只存了连通性而没有存值，所以在<code>Network</code>中需要更改的只有</p>
<ul>
<li><code>addPerson</code>中<code>add</code>结点</li>
<li><code>addRelation</code>中<code>union</code></li>
<li><code>modifyRelation</code>中若为断关系则<code>breakup</code></li>
</ul>
<p><code>blockCnt</code>连通块个数</p>
<ul>
<li>加人的时候++</li>
<li>加关系时若导致两块连通—</li>
<li>删关系时若导致分裂成两块++</li>
</ul>
<p><code>tripleCnt</code>三元闭包个数</p>
<ul>
<li>加关系的时候先加再查</li>
<li>删关系的时候先查再减</li>
</ul>
<h3 id="CoupleSum"><a href="#CoupleSum" class="headerlink" title="CoupleSum"></a>CoupleSum</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="variable">coupleSum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">coupleDirty</span> <span class="operator">=</span> <span class="literal">true</span>;  <span class="comment">//由checkBefore()和checkAfter()比对判断是否需要设置脏位</span></span><br><span class="line"><span class="keyword">private</span> HashSet&lt;Person&gt; noMatch = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br></pre></td></tr></table></figure>
<h3 id="ValueSum"><a href="#ValueSum" class="headerlink" title="ValueSum"></a>ValueSum</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//间接管理</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">modifyValueSum</span><span class="params">(Person p1, Person p2, <span class="type">int</span> oldValue, <span class="type">int</span> newValue)</span> {</span><br><span class="line">        <span class="keyword">for</span> (Person person : ((MyPerson) p1).getAcquaintance()) {</span><br><span class="line">            <span class="keyword">if</span> (person.getId() != p2.getId() &amp;&amp; person.isLinked(p2)) {</span><br><span class="line">                <span class="keyword">for</span> (Tag tag : ((MyPerson) person).getTags()) {</span><br><span class="line">                    <span class="keyword">if</span> (tag.hasPerson(p1) &amp;&amp; tag.hasPerson(p2)) {</span><br><span class="line">                        ((MyTag) tag).modifyValueSum(oldValue, newValue); } } } }</span><br><span class="line">        <span class="keyword">if</span> (delete) {</span><br><span class="line">            submodify(p1, p2);</span><br><span class="line">            submodify(p2, p1); }</span><br><span class="line">        delete = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接管理</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">submodify</span><span class="params">(Person p1, Person p2)</span> {</span><br><span class="line">        <span class="keyword">for</span> (Tag tag : ((MyPerson) p1).getTags()) {</span><br><span class="line">            <span class="keyword">if</span> (tag.hasPerson(p2)) {</span><br><span class="line">                <span class="keyword">for</span> (Person p : ((MyTag) tag).getPersons()) {</span><br><span class="line">                    <span class="keyword">if</span> (p.getId() != p2.getId() &amp;&amp; p.isLinked(p2)) {</span><br><span class="line">                        ((MyTag) tag).modifyValueSum(p2.queryValue(p), <span class="number">0</span>); } } } } }</span><br></pre></td></tr></table></figure>
<h3 id="EmojiMessages"><a href="#EmojiMessages" class="headerlink" title="EmojiMessages"></a>EmojiMessages</h3><p>考虑到信息数量可以非常多，所以也加上了一点点优化，可以省去对<code>message</code>的遍历</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> HashMap&lt;Integer, Message&gt; messages = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> HashMap&lt;Integer, Integer&gt; emojis = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> HashMap&lt;Integer, HashSet&lt;Integer&gt;&gt; emojiMessages = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteColdEmoji</span><span class="params">(<span class="type">int</span> limit)</span> {</span><br><span class="line">        emojis.entrySet().removeIf(entry -&gt; entry.getValue() &lt; limit);</span><br><span class="line">        Iterator&lt;Integer&gt; iterator = emojiMessages.keySet().iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) {</span><br><span class="line">            <span class="type">int</span> <span class="variable">eid</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            <span class="keyword">if</span> (!emojis.containsKey(eid)) {</span><br><span class="line">                <span class="keyword">for</span> (Integer mid : emojiMessages.get(eid)) { messages.remove(mid); }</span><br><span class="line">                iterator.remove(); } }</span><br><span class="line">        <span class="keyword">return</span> emojis.size();</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<h2 id="JUnit"><a href="#JUnit" class="headerlink" title="JUnit"></a>JUnit</h2><p>在编写测试时，我们可以将JML规格视为一种模板或蓝图，然后根据这些规格来编写代码和测试。这种直白的“翻译”过程确保了代码和测试与规格保持一致，从而提高了代码的质量和可维护性。</p>
<p>总体而言测试可以分为这样几步：</p>
<ul>
<li>实例化对象构造数据</li>
<li>调用方法得到结果</li>
<li>（异常）判断异常是否能被正常捕获</li>
<li>（正常）逐行判断ensures是否满足</li>
</ul>
<h2 id="心得体会"><a href="#心得体会" class="headerlink" title="心得体会"></a>心得体会</h2><p>JML描述的前置条件、后置条件和副作用，可以使得代码更容易被程序员理解和维护，也便于我们编写测试来验证代码的正确性。理论来讲，本单元最大的收获应该是学习如何编写更清晰、更可靠、更易于维护的代码。然而实际上，由于测评形式原因，感觉本单元更多的精力还是用在优化算法上了，虽然也是学习指标中的一环，但似乎有点本末倒置？？总归来讲有学长学姐博客助力实现压力已经小很多了，课程组也对JML进行合理的优化减少不必要的困扰，还是很好的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/21/%E3%80%90GAMES101%E3%80%91note1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/21/%E3%80%90GAMES101%E3%80%91note1/" class="post-title-link" itemprop="url">【GAMES101】note1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-04-21 21:16:11" itemprop="dateCreated datePublished" datetime="2024-04-21T21:16:11+08:00">2024-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-05-22 21:24:51" itemprop="dateModified" datetime="2024-05-22T21:24:51+08:00">2024-05-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Linear-Algebra"><a href="#Linear-Algebra" class="headerlink" title="Linear Algebra"></a>Linear Algebra</h2><h3 id="dual-matrix"><a href="#dual-matrix" class="headerlink" title="dual matrix"></a>dual matrix</h3><p>叉乘可以被表示成矩阵形式</p>
<p><img src="/images/【GAMES101】note1/image-20240421233525620.png" alt="image-20240421233525620" style="zoom:67%;"></p>
<h3 id="homogenous-coordinates"><a href="#homogenous-coordinates" class="headerlink" title="homogenous coordinates"></a>homogenous coordinates</h3><p>一般的transformation包括：</p>
<ul>
<li>scale</li>
<li>shear</li>
<li>rotate</li>
<li>translation</li>
</ul>
<p>上面三种都可以通过乘一个向量实现变换，但translation需要通过矩阵加法而非乘法实现变化。我们希望统一形式，让乘法能够完成所有变换操作，于是便引入了<strong>齐次坐标</strong>的概念，给n维的坐标再多加1维，进而可以把加法用乘法表示出来。</p>
<p><img src="/images/【GAMES101】note1/image-20240421224850309.png" alt="image-20240421224850309" style="zoom:67%;"></p>
<p><img src="/images/【GAMES101】note1/image-20240421224729611.png" alt="image-20240421224729611" style="zoom:67%;"></p>
<h3 id="decomposing-complex-transforms"><a href="#decomposing-complex-transforms" class="headerlink" title="decomposing complex transforms"></a>decomposing complex transforms</h3><p>How to rotate around a given point c?</p>
<ol>
<li>translate center to origin</li>
<li>rotate</li>
<li>translate back</li>
</ol>
<p><strong>Matrix multiplication is not commutative.</strong></p>
<h3 id="Rodrigues’s-Rotation-Formula"><a href="#Rodrigues’s-Rotation-Formula" class="headerlink" title="Rodrigues’s Rotation Formula"></a>Rodrigues’s Rotation Formula</h3><p><img src="/images/【GAMES101】note1/image-20240425140053399.png" alt="image-20240425140053399" style="zoom:67%;"></p>
<p>任意向量绕指定轴（默认通过原点）旋转<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 640 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></g></g></g></svg></mjx-container>角。</p>
<h2 id="transformation-cont"><a href="#transformation-cont" class="headerlink" title="transformation cont"></a>transformation cont</h2><ul>
<li>model transformation</li>
<li>view transformation</li>
<li>projection transformation</li>
</ul>
<h3 id="view-camera-transformation"><a href="#view-camera-transformation" class="headerlink" title="view/camera transformation"></a>view/camera transformation</h3><p><img src="/images/【GAMES101】note1/image-20240425141549485.png" alt="image-20240425141549485" style="zoom:67%;"></p>
<p><img src="/images/【GAMES101】note1/image-20240425141605260.png" alt="image-20240425141605260" style="zoom:67%;"></p>
<p>旋转矩阵是正交矩阵，故其逆就是他的转置</p>
<h3 id="projection-transformation"><a href="#projection-transformation" class="headerlink" title="projection transformation"></a>projection transformation</h3><h4 id="orthographic-projection"><a href="#orthographic-projection" class="headerlink" title="orthographic projection"></a>orthographic projection</h4><p>平行的线仍然平行</p>
<p>[l, r] <em> [b, t] </em> [f, n] to [-1, 1]^3</p>
<p><img src="/images/【GAMES101】note1/image-20240425144746746.png" alt="image-20240425144746746" style="zoom:67%;"></p>
<h4 id="perspective-projection"><a href="#perspective-projection" class="headerlink" title="perspective projection"></a>perspective projection</h4><p>平行的线不再平行</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.65ex;" xmlns="http://www.w3.org/2000/svg" width="27.851ex" height="2.195ex" role="img" focusable="false" viewBox="0 -683 12310.3 970.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1003,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(969,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1420,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(1889,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g><g data-mml-node="mo" transform="translate(3022.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(4078,0)"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1003,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(485,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(936,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(1297,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1873,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g></g></g><g data-mml-node="msub" transform="translate(6798.3,0)"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1003,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(969,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1420,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(1889,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(2392,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mo" transform="translate(3170,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path></g><g data-mml-node="mi" transform="translate(3948,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(4433,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4884,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(5245,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(5821,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g></g></g></g></g></svg></mjx-container></p>
<script type="math/tex; mode=display">
M_{persp->otho} = \begin{pmatrix}
n&0&0&0\\
0&n&0&0\\
0&0&n+f&-nf\\
0&0&1&0
\end{pmatrix}</script><p><strong>field-of-view</strong>(fovY): <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="17.987ex" height="3.167ex" role="img" focusable="false" viewBox="0 -1047.1 7950.4 1399.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(890,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mfrac" transform="translate(1490,0)"><g data-mml-node="mrow" transform="translate(220,485) scale(0.707)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(550,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1035,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(1520,0)"><path data-c="1D44C" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path></g></g><g data-mml-node="mn" transform="translate(850.4,-345) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><rect width="1814.3" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(3822.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(4877.9,0)"><g data-mml-node="mrow" transform="translate(357.2,516.8) scale(0.707)"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(576,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(921,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(1398,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1974,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2335,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(2835,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(865,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(1334,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(1695,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(2224,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2824,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3257,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g></g><rect width="2832.6" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p>
<p><strong>aspect ratio</strong>: width / hight</p>
<blockquote>
<p> MVP：<strong>M</strong>odel transformation (placing objects)， <strong>V</strong>iew transformation (placing camera)，<strong>P</strong>rojection transformation</p>
</blockquote>
<h2 id="rasterization"><a href="#rasterization" class="headerlink" title="rasterization"></a>rasterization</h2><p><strong>Real-Time Rendering Pipeline</strong>: Application -&gt; Geometry Processing -&gt; Rasterization -&gt; Pixel Processing</p>
<h3 id="canonical-cube-to-screen"><a href="#canonical-cube-to-screen" class="headerlink" title="canonical cube to screen"></a>canonical cube to screen</h3><p><strong>view transformation</strong>: cuboid -&gt; canonical cube -(viewport transform matrix)&gt; screen</p>
<script type="math/tex; mode=display">
M_{viewport} = \begin{pmatrix}
width/2&0&0&width/2\\
0&height/2&0&height/2\\
0&0&1&0\\
0&0&0&1
\end{pmatrix}</script><ul>
<li><strong>triangles</strong> as fundamental shape primitives</li>
<li><strong>pixel</strong> values approximate triangles(Sampling)</li>
</ul>
<h3 id="sampling"><a href="#sampling" class="headerlink" title="sampling"></a>sampling</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">0</span>; x &lt; xmax; ++x){</span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">0</span>; y &lt; ymax; ++y){</span><br><span class="line">  image[x][y] = inside(tri, x + <span class="number">0.5</span>, y + <span class="number">0.5</span>);</span><br><span class="line"> }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>inside:</p>
<h2 id="Shading"><a href="#Shading" class="headerlink" title="Shading"></a>Shading</h2><h2 id="补充链接"><a href="#补充链接" class="headerlink" title="补充链接"></a>补充链接</h2><p>伟大无需多言：</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1X7411F744/">https://www.bilibili.com/video/BV1X7411F744/</a></p>
<p>光栅化和着色的文章：</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/450540827">https://zhuanlan.zhihu.com/p/450540827</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/452687345">https://zhuanlan.zhihu.com/p/452687345</a></p>
<p>什么都有一点：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1693716204211023872">https://www.zhihu.com/column/c_1693716204211023872</a></p>
<p>GAMES笔记：</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1272231503708475392">https://www.zhihu.com/column/c_1272231503708475392</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1249465121615204352">https://www.zhihu.com/column/c_1249465121615204352</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/19/%E3%80%90OO%E3%80%91hw2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/19/%E3%80%90OO%E3%80%91hw2/" class="post-title-link" itemprop="url">【OO】hw2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-04-19 10:04:53" itemprop="dateCreated datePublished" datetime="2024-04-19T10:04:53+08:00">2024-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-20 15:31:12" itemprop="dateModified" datetime="2024-04-20T15:31:12+08:00">2024-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OO/" itemprop="url" rel="index"><span itemprop="name">OO</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>第二单元博客作业</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/04/19/%E3%80%90OO%E3%80%91hw2/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/15/%E3%80%90OS%E3%80%91memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Carbon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="碳罐堆积处">
      <meta itemprop="description" content="还没想出高级的博客名；出现问题欢迎交流指正喵。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 碳罐堆积处">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/15/%E3%80%90OS%E3%80%91memory/" class="post-title-link" itemprop="url">【OS】memory</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-04-15 23:14:42" itemprop="dateCreated datePublished" datetime="2024-04-15T23:14:42+08:00">2024-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-06-05 21:32:45" itemprop="dateModified" datetime="2024-06-05T21:32:45+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>概论，启动和内存管理理论总结。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/04/15/%E3%80%90OS%E3%80%91memory/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Carbon</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
